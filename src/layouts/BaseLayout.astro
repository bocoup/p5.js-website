---
import LocaleSwitcher from "@components/LocaleSwitcher/index.astro";
import Footer from "@/src/components/Footer/index.astro";
import SearchForm from "@components/SearchForm/index.astro";
import RootPageHeader from "@components/RootPageHeader/index.astro";
import { AccessibilitySettings } from "@components/AccessibilitySettings/";
import { getCurrentLocale, useTranslations } from "@i18n/utils";
import "@styles/base.scss";

interface BaseLayoutProps {
  title: string;
  subtitle: string;
  className?: string;
  variant: "root" | "secondary";
}

const {
  title,
  subtitle,
  className = "",
  variant = "root",
} = Astro.props as BaseLayoutProps;
const currentLocale = getCurrentLocale(Astro.url.pathname);
const t = await useTranslations(currentLocale);
const localizedTitle = t(title);
const localizedSubtitle = t("briefPageDescriptions", title);
---

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body class={`${title.toLowerCase()} ${className}`}>
    <nav>
      <ul>
        <a href="/">{t("Home")}</a>
        <a href="/reference">{t("Reference")}</a>
        <a href="/tutorials">{t("Tutorials")}</a>
        <a href="/examples">{t("Examples")}</a>
        <a href="/community">{t("Community")}</a>
        <a href="/about">{t("About")}</a>
        <a href="/contribute">{t("Contribute")}</a>
      </ul>
    </nav>
    <div class="flex space-x-2">
      <LocaleSwitcher />
      <div><SearchForm /></div>
      <div>Language: {currentLocale}</div>
      <AccessibilitySettings client:only />
    </div>
    <header>
      {
        variant === "root" ? (
          <div>
            <RootPageHeader
              title={localizedTitle}
              subtitle={localizedSubtitle}
            />
          </div>
        ) : (
          <div>
            <h1>{title}</h1>
          </div>
        )
      }
      <main>
        <slot />
      </main>
      <Footer />
    </header>
  </body>
</html>
